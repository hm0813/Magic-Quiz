/* default neutral vars; theme.ts sets them to house colors */
:root{
  --hp-primary: #222;
  --hp-secondary: #999;
  --hp-surface: #f5f5f4;
  --hp-text: #111827;
}

.hp-text-primary   { color: var(--hp-primary); }
.hp-text-secondary { color: var(--hp-secondary); }
.hp-bg-surface     { background-color: var(--hp-surface); }
.hp-bg-primary     { background-color: var(--hp-primary); }
.hp-border-primary { border-color: var(--hp-primary); }

.hp-card {
  background: var(--hp-surface);
  color: var(--hp-text);
  border: 1px solid rgba(0,0,0,0.08);
  border-radius: 1rem;
  box-shadow: 0 10px 20px rgba(0,0,0,0.05);
}

/* house-name accent colors (optional) */
body[data-house="gryffindor"] .house-name { color: #7F0909; }
body[data-house="slytherin"]  .house-name { color: #1A472A; }
body[data-house="ravenclaw"]  .house-name { color: #0E1A40; }
body[data-house="hufflepuff"] .house-name { color: #ECB939; }

/* --- Crest magic animations --- */
@keyframes hp-float {
  0%   { transform: translateY(0px); }
  50%  { transform: translateY(-6px); }
  100% { transform: translateY(0px); }
}

@keyframes hp-glow {
  0%   { filter: drop-shadow(0 0 0px rgba(255,255,255,0.0)) drop-shadow(0 4px 12px rgba(0,0,0,0.15)); }
  50%  { filter: drop-shadow(0 0 10px rgba(255,255,255,0.35)) drop-shadow(0 6px 16px rgba(0,0,0,0.2)); }
  100% { filter: drop-shadow(0 0 0px rgba(255,255,255,0.0)) drop-shadow(0 4px 12px rgba(0,0,0,0.15)); }
}

.hp-crest-wrap {
  position: relative;
  width: 7rem;
  height: 7rem;
  margin-left: auto;
  margin-right: auto;
  border-radius: 9999px;
  background: radial-gradient(closest-side, rgba(255,255,255,0.65), transparent 70%);
}

.hp-crest-wrap::before {
  content: "";
  position: absolute;
  inset: -6px;
  border-radius: inherit;
  background: conic-gradient(from 0deg,
    var(--hp-primary) 0 25%,
    var(--hp-secondary) 25% 50%,
    transparent 50% 100%);
  filter: blur(10px) opacity(.45);
  animation: spin 5.5s linear infinite;
  z-index: 0;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.hp-crest {
  position: relative;
  z-index: 1;
  width: 100%;
  height: 100%;
  object-fit: contain;
  animation: hp-float 3.2s ease-in-out infinite, hp-glow 2.6s ease-in-out infinite;
}
/* --- PHASE 2: Marauder’s Map styles --- */

/* parchment card surface (for the map canvas) */
.hp-parchment {
  background:
    radial-gradient(ellipse at center, rgba(0,0,0,0.04), rgba(0,0,0,0) 60%),
    url("/assets/map/parchment.jpg");
  background-size: cover;
  background-position: center;
  border-radius: 1rem;
  border: 1px solid rgba(0,0,0,0.12);
  box-shadow: 0 20px 40px rgba(0,0,0,0.08);
}

/* subtle paper texture fallback if image missing */
@media (prefers-reduced-data: reduce) {
  .hp-parchment { background: radial-gradient(#f7f1df, #efe7c9); }
}

/* room buttons */
.hp-room {
  position: absolute;
  transform: translate(-50%, -50%);
  padding: .6rem 1rem;
  border-radius: 9999px;
  background: rgba(255,255,255,0.75);
  border: 1px dashed rgba(0,0,0,0.35);
  backdrop-filter: blur(2px);
  transition: transform .18s ease, box-shadow .18s ease, background .18s ease;
  user-select: none;
}
.hp-room:hover {
  transform: translate(-50%, -50%) scale(1.04);
  box-shadow: 0 10px 20px rgba(0,0,0,0.12);
  background: rgba(255,255,255,0.9);
}

/* ink ripple */
.hp-ink::after {
  content: "";
  position: absolute;
  inset: -6px;
  border-radius: inherit;
  border: 2px solid rgba(0,0,0,0.2);
  opacity: 0;
  transform: scale(0.9);
}
.hp-room:hover.hp-ink::after {
  animation: hp-ink-ripple .6s ease-out;
}
@keyframes hp-ink-ripple {
  from { opacity: .35; transform: scale(0.95); }
  to   { opacity: 0;    transform: scale(1.2); }
}

/* footprints trail effect (animated background image sweep) */
.hp-footprints {
  --fp-url: url("/assets/map/footprints.svg");
  position: absolute; inset: 0;
  background-image: var(--fp-url);
  background-repeat: no-repeat;
  background-size: 48px auto;
  opacity: 0;
  pointer-events: none;
  transition: opacity .2s ease;
}
.hp-footprints { background-size: 64px auto; opacity: .7; }
.hp-room:hover ~ .hp-footprints { opacity: .55; }
.hp-room:focus-visible ~ .hp-footprints {
  opacity: .55;
}

/* Four pre-defined footprint paths using background-position animation */
.hp-fp-greathall { animation: fp-move-1 2.6s linear infinite; }
.hp-fp-library   { animation: fp-move-2 2.8s linear infinite; }
.hp-fp-potions   { animation: fp-move-3 3.0s linear infinite; }
.hp-fp-quidditch { animation: fp-move-4 2.4s linear infinite; }

@keyframes fp-move-1 { 
  0% { background-position: 12% 86%; } 
  100% { background-position: 28% 58%; } 
}
@keyframes fp-move-2 { 
  0% { background-position: 72% 76%; } 
  100% { background-position: 58% 48%; } 
}
@keyframes fp-move-3 { 
  0% { background-position: 36% 28%; } 
  100% { background-position: 46% 52%; } 
}
@keyframes fp-move-4 { 
  0% { background-position: 84% 26%; } 
  100% { background-position: 70% 40%; } 
}
/* --- Map room icons --- */
.hp-room-icon {
  width: 18px;
  height: 18px;
  opacity: .8;
  transform: translateY(0);
  transition: transform .18s ease, opacity .18s ease;
}
.hp-room:hover .hp-room-icon,
.hp-room:focus-visible .hp-room-icon {
  transform: translateY(-1px);
  opacity: 1;
}
/* --- Mischief Managed overlay --- */
@keyframes hp-mm-wipe {
  0%   { clip-path: circle(0% at 50% 50%); opacity: 0; }
  100% { clip-path: circle(140% at 50% 50%); opacity: 1; }
}

.hp-mm-overlay {
  position: absolute;
  inset: 0;
  /* parchment-y background (uses your parchment image if present) */
  background:
    radial-gradient(ellipse at center, rgba(0,0,0,0.15), rgba(0,0,0,0) 60%),
    url("/assets/map/parchment.jpg"),
    #efe7c9;
  background-size: cover;
  background-position: center;
  animation: hp-mm-wipe 420ms ease-out forwards;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 40; /* above rooms/footprints */
}

.hp-mm-text {
  font-size: clamp(24px, 4vw, 40px);
  font-weight: 800;
  letter-spacing: 0.5px;
  color: rgba(0,0,0,0.8);
  text-shadow: 0 2px 8px rgba(0,0,0,0.2);
  transform: rotate(-1deg) scale(0.98);
  opacity: 0;
  animation: hp-mm-text-in 120ms ease-out 20ms forwards;
}

@keyframes hp-mm-text-in {
  from { opacity: 0; letter-spacing: -0.02em; transform: rotate(-2deg) scale(0.94); }
  to   { opacity: .95; letter-spacing: 0;      transform: rotate(-1deg) scale(1); }
}
/* --- PHASE 3: Quiz UI --- */
.hp-potion {
  position: relative;
  width: 56px;
  height: 80px;
  border: 2px solid rgba(0,0,0,.45);
  border-radius: 12px 12px 18px 18px;
  background: linear-gradient(#faf7ef, #efe7d0);
  box-shadow: inset 0 2px 8px rgba(0,0,0,.08);
}
.hp-potion::after {
  /* liquid fill */
  content: "";
  position: absolute;
  left: 4px; right: 4px; bottom: 4px;
  height: var(--fill, 0%); /* set from React */
  background: linear-gradient(180deg, var(--hp-primary), var(--hp-secondary));
  border-radius: 8px 8px 14px 14px;
  transition: height .35s ease;
  box-shadow: inset 0 0 10px rgba(255,255,255,.35);
}

.hp-bubble {
  position: absolute; bottom: 10px; left: 50%;
  width: 6px; height: 6px; border-radius: 9999px;
  background: rgba(255,255,255,.9);
  opacity: .0; transform: translateX(-50%) translateY(6px) scale(.8);
  animation: hp-bub 1.8s ease-in-out infinite;
}
.hp-bubble:nth-child(2){ left: 35%; animation-delay:.2s }
.hp-bubble:nth-child(3){ left: 65%; animation-delay:.35s }
@keyframes hp-bub {
  0% { opacity:0; transform: translate(-50%,6px) scale(.8) }
  30%{ opacity:.9;}
  100%{ opacity:0; transform: translate(-50%,-18px) scale(1) }
}

/* answer feedback */
.hp-answer {
  transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
}
.hp-answer:active { transform: scale(.99); }
.hp-correct { background: #ecfdf5; border-color: #10b981 !important; box-shadow: 0 6px 16px rgba(16,185,129,.25); }
.hp-wrong   { background: #fef2f2; border-color: #ef4444 !important; box-shadow: 0 6px 16px rgba(239,68,68,.2); }
/* --- Strong parchment background for the map --- */
.hp-map-bg {
  background:
    radial-gradient(ellipse at center, rgba(0,0,0,0.12), rgba(0,0,0,0) 62%),
    url("/assets/map/parchment.jpg"),
    linear-gradient(#f7f1df, #efe7c9);
  background-size: cover;
  background-position: center;
}

/* Keep your previous parchment card look */
.hp-parchment {
  border-radius: 1rem;
  border: 1px solid rgba(0,0,0,0.12);
  box-shadow: 0 20px 40px rgba(0,0,0,0.08);
}

/* --- Mischief Managed overlay (keeps anim clean even when longer) --- */
@keyframes hp-mm-wipe {
  0%   { clip-path: circle(0% at 50% 50%); opacity: 0; }
  100% { clip-path: circle(140% at 50% 50%); opacity: 1; }
}
.hp-mm-overlay {
  position: absolute; inset: 0;
  background:
    radial-gradient(ellipse at center, rgba(0,0,0,0.15), rgba(0,0,0,0) 60%),
    url("/assets/map/parchment.jpg"),
    #efe7c9;
  background-size: cover;
  background-position: center;
  display: flex; align-items: center; justify-content: center;
  z-index: 40;
  /* duration is controlled from React via inline style now */
}
.hp-mm-text {
  font-size: clamp(24px, 4vw, 40px);
  font-weight: 800;
  letter-spacing: 0.5px;
  color: rgba(0,0,0,0.85);
  text-shadow: 0 2px 8px rgba(0,0,0,0.2);
  transform: rotate(-1deg) scale(0.98);
  opacity: 0;
  animation: hp-mm-text-in 360ms ease-out 160ms forwards;
}
@keyframes hp-mm-text-in {
  from { opacity: 0; letter-spacing: -0.02em; transform: rotate(-2deg) scale(0.94); }
  to   { opacity: .96; letter-spacing: 0;      transform: rotate(-1deg) scale(1); }
}
/* === REAL MARAUDER'S MAP VIBE === */

/* Global map font */
.hp-map-font { font-family: 'IM Fell English', ui-serif, Georgia, 'Times New Roman', serif; }

/* Strong parchment background + vignette + speckle */
.hp-map-bg {
  background:
    radial-gradient(ellipse at center, rgba(0,0,0,0.18), rgba(0,0,0,0) 62%),
    url("/assets/map/parchment.jpg"),
    linear-gradient(#f6eed1, #efe2b9);
  background-size: cover;
  background-position: center;
  filter: sepia(.25) contrast(1.02) saturate(.9);
  position: relative;
}
.hp-parchment {
  border-radius: 14px;
  border: 1.5px solid rgba(34, 24, 6, 0.35);
  box-shadow: 0 28px 60px rgba(0,0,0,0.18), inset 0 0 0 1px rgba(255,255,255,.25);
}

/* Paper edge vignette */
.hp-map-bg::after {
  content: "";
  position: absolute; inset: 0;
  pointer-events: none;
  background:
    radial-gradient(120% 85% at 50% 50%, transparent 40%, rgba(0,0,0,.18) 100%),
    radial-gradient(60% 40% at 50% -10%, rgba(0,0,0,.18), transparent 60%);
  mix-blend-mode: multiply;
  border-radius: inherit;
}

/* Subtle fold lines */
.hp-folds::before,
.hp-folds::after {
  content: "";
  position: absolute; inset: 0;
  background:
    repeating-linear-gradient(90deg,
      rgba(40,30,10,.12) 0 1px, transparent 1px 180px),
    repeating-linear-gradient(0deg,
      rgba(40,30,10,.08) 0 1px, transparent 1px 140px);
  opacity: .28;
  border-radius: inherit;
  pointer-events: none;
}

/* Antique title ribbon */
.hp-map-title {
  display: inline-flex; align-items: center; gap: .6rem;
  padding: .35rem .9rem;
  border: 1px solid rgba(34,24,6,.45);
  border-radius: 9999px;
  background: rgba(255,255,255,.55);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.5);
  letter-spacing: .02em;
}

/* Ink lines (paths drawn on reveal) */
@keyframes hp-ink-draw {
  from { stroke-dashoffset: 420; opacity: .7; }
  to   { stroke-dashoffset: 0;   opacity: 1; }
}
.hp-ink-path {
  stroke: rgba(34,24,6,.85);
  stroke-width: 1.2;
  fill: none;
  stroke-linecap: round;
  stroke-linejoin: round;
  stroke-dasharray: 420;
  animation: hp-ink-draw 1600ms ease-out forwards;
}

/* Room labels (pills) refined */
.hp-room {
  position: absolute; transform: translate(-50%,-50%);
  padding: .5rem .85rem; border-radius: 9999px;
  background: rgba(255,255,255,.7);
  border: 1px dashed rgba(34,24,6,.55);
  backdrop-filter: blur(1.5px);
  transition: transform .18s ease, box-shadow .18s ease, background .18s ease;
  font-family: 'IM Fell English', ui-serif, Georgia, serif;
  color: #1e1408;
}
.hp-room:hover { transform: translate(-50%,-50%) scale(1.04); background: rgba(255,255,255,.88); box-shadow: 0 10px 22px rgba(0,0,0,.16); }

/* Ink ripple on hover */
.hp-ink::after {
  content:""; position:absolute; inset:-6px; border-radius:inherit;
  border: 2px solid rgba(34,24,6,.35); opacity:0; transform:scale(.9);
}
@keyframes hp-ink-ripple { from{opacity:.35; transform:scale(.95)} to{opacity:0; transform:scale(1.2)} }
.hp-room:hover.hp-ink::after { animation: hp-ink-ripple .6s ease-out; }

/* Footprints (stronger) */
.hp-footprints {
  --fp-url: url("/assets/map/footprints.svg");
  position:absolute; inset:0; background-image: var(--fp-url);
  background-repeat:no-repeat; background-size: 64px auto; opacity:0; pointer-events:none; transition:opacity .2s ease;
}
.hp-room:hover ~ .hp-footprints,
.hp-room:focus-visible ~ .hp-footprints { opacity:.65; }
.hp-fp-greathall { animation: fp-move-1 2.6s linear infinite; }
.hp-fp-library   { animation: fp-move-2 2.8s linear infinite; }
.hp-fp-potions   { animation: fp-move-3 3.0s linear infinite; }
.hp-fp-quidditch { animation: fp-move-4 2.4s linear infinite; }
@keyframes fp-move-1 { 0%{background-position: 12% 86%} 100%{background-position: 28% 58%} }
@keyframes fp-move-2 { 0%{background-position: 72% 76%} 100%{background-position: 58% 48%} }
@keyframes fp-move-3 { 0%{background-position: 36% 28%} 100%{background-position: 46% 52%} }
@keyframes fp-move-4 { 0%{background-position: 84% 26%} 100%{background-position: 70% 40%} }

/* “Reveal Map” screen */
.hp-reveal {
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  gap:.8rem; text-align:center; padding:2.5rem;
  color:#1e1408;
}
.hp-reveal button {
  padding:.5rem 1rem; border-radius:9999px; border:1px solid rgba(34,24,6,.5);
  background: rgba(255,255,255,.7); font-weight:700;
}
.hp-reveal button:hover { background: rgba(255,255,255,.9); }

/* Mischief Managed overlay stays same; timing controlled inline */
/* --- Footprints (inline SVG or file) --- */
.hp-footprints {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 8;                       /* above ink/background, below room pills */
  background-image: var(--fp-url);  /* you will set this inline from React */
  background-repeat: no-repeat;
  background-size: 56px auto;       /* tweak if you want smaller/larger prints */
  opacity: .45;                     /* visible even without hover */
  transition: opacity .25s ease;
  mix-blend-mode: multiply;         /* look like ink on parchment */
}

/* a little stronger on hover for “living” effect */
.hp-map:hover .hp-footprints { opacity: .70; }

/* animation paths (you can tweak start/end positions) */
.hp-fp-greathall { animation: fp-move-1 3.2s linear infinite; }
.hp-fp-library   { animation: fp-move-2 3.4s linear infinite; }
.hp-fp-potions   { animation: fp-move-3 3.6s linear infinite; }
.hp-fp-quidditch { animation: fp-move-4 3.0s linear infinite; }

@keyframes fp-move-1 { 0% {background-position: 12% 86%} 100% {background-position: 30% 58%} }
@keyframes fp-move-2 { 0% {background-position: 74% 76%} 100% {background-position: 58% 48%} }
@keyframes fp-move-3 { 0% {background-position: 34% 28%} 100% {background-position: 46% 54%} }
@keyframes fp-move-4 { 0% {background-position: 86% 26%} 100% {background-position: 70% 40%} }
/* Movie prop background */
.hp-map-bg {
  background:
    linear-gradient(rgba(0,0,0,.06), rgba(0,0,0,.06)), /* faint global tone */
    url("/assets/map/marauders-wide.jpg"),
    radial-gradient(circle at 50% 50%, #f6eed1, #efe2b9);
  background-size: cover;
  background-position: center;
  filter: sepia(.28) contrast(1.02) saturate(.92);
  position: relative;
}

/* Card edges + subtle white inner highlight */
.hp-parchment {
  border-radius: 14px;
  border: 1.5px solid rgba(34, 24, 6, 0.35);
  box-shadow:
    0 28px 60px rgba(0,0,0,0.18),
    inset 0 0 0 1px rgba(255,255,255,.20);
}

/* Strong edge vignette over the map image */
.hp-map-bg::after {
  content: "";
  position: absolute; inset: 0; pointer-events: none; border-radius: inherit;
  background:
    radial-gradient(115% 80% at 50% 50%, transparent 45%, rgba(0,0,0,.22) 100%),
    radial-gradient(60% 40% at 50% -10%, rgba(0,0,0,.18), transparent 60%);
  mix-blend-mode: multiply;
}

/* Fold lines overlay (vertical + horizontal repeats) */
.hp-folds::before, .hp-folds::after {
  content: "";
  position: absolute; inset: 0; pointer-events: none; border-radius: inherit;
  background:
    repeating-linear-gradient(90deg,
      rgba(40,30,10,.18) 0 1px, transparent 1px 220px),
    repeating-linear-gradient(0deg,
      rgba(40,30,10,.10) 0 1px, transparent 1px 160px);
  opacity: .30;
}
/* Map parchment background */
.hp-map {
  background-image: url("/assets/map/marauders-wide.jpg");
  background-size: cover;        /* fill entire container */
  background-position: center;   /* keep centered */
  background-repeat: no-repeat;
  filter: sepia(0.5) contrast(1.1) brightness(0.95);
}
.hp-footprints {
  position: absolute;
  width: 64px;
  height: 32px;
  background-image: var(--fp-url);
  background-size: contain;
  background-repeat: no-repeat;
  opacity: 0.7;
  animation: hp-footstep 2s infinite linear;
}

/* footprints for each room (you can reposition them) */
.hp-fp-greathall { left: 22%; top: 80%; }
.hp-fp-library   { left: 70%; top: 76%; }
.hp-fp-potions   { left: 30%; top: 34%; }
.hp-fp-quidditch { left: 84%; top: 28%; }

@keyframes hp-footstep {
  0%   { transform: translate(0, 0) scale(1); opacity: 0; }
  20%  { opacity: 1; }
  80%  { opacity: 1; }
  100% { transform: translate(30px, -30px) scale(1.1); opacity: 0; }
}
.hp-ink-path {
  stroke: #4b2e2e;
  stroke-width: 0.6;
  fill: none;
  stroke-dasharray: 180;
  stroke-dashoffset: 180;
  animation: hp-ink-draw 2s ease forwards;
}

@keyframes hp-ink-draw {
  to {
    stroke-dashoffset: 0;
  }
}
/* Buttons used in quiz lifelines */
.hp-btn {
  padding: .45rem .9rem;
  border: 1px solid rgba(28, 23, 15, .25);
  background: rgba(255,255,255,.8);
  border-radius: .75rem;
  font-weight: 700;
  transition: transform .12s ease, box-shadow .12s ease, background .12s ease, opacity .12s ease;
}
.hp-btn:hover { transform: translateY(-1px); background: rgba(255,255,255,.95); box-shadow: 0 8px 16px rgba(0,0,0,.08); }
.hp-btn:disabled { opacity: .45; cursor: not-allowed; }

/* Potion bar “glass” texture */
.hp-potion-grid {
  background:
    linear-gradient(0deg, rgba(255,255,255,.18), rgba(255,255,255,0)),
    repeating-linear-gradient(90deg, rgba(0,0,0,.04) 0 1px, transparent 1px 10px);
}
